/**
 * For making material coefficients available in project_kernel.cu.
 * 
 * The values in this file are based off of material_coefficients.py, 
 * which is in turn based off of X-Ray Mass Attenuation Coefficients from NIST 
 * (https://www.nist.gov/pml/x-ray-mass-attenuation-coefficients)
 */

 /**
  * Value obtained as follows:
  *     1. navigate to directory containing material_coefficients.py
  *     2.  >>> python
  *         >>> import material_coefficients as mc
  *         >>> f = open("TEMP.txt","w")
  *         >>> for val in mc.air[:,0]
  *         ...     f.write("{:e}".format(val) + ",\n")
  *         ...
  *         >>> f.close()
  *     3. repeat Step 2 as necessary
  */

typedef enum materialType {
    MAT_AIR,
    MAT_BONE,
    MAT_SOFT_TISSUE,
    MAT_IRON,
    MAT_LUNG,
    MAT_TITANIUM,
    MAT_TEFLON,
    MAT_AIR_EXTERNAL,
    MAT_BONE_EXTERNAL,
    MAT_SOFT_TISSUE_EXTERNAL,
    MAT_IRON_EXTERNAL,
    MAT_LUNG_EXTERNAL,
    MAT_TITANIUM_EXTERNAL,
    MAT_TEFLON_EXTERNAL
} materialType_t;

__device__ int mat_number_of_vals(materialType_t mat) {
    if (MAT_AIR == mat) { return 38; }
    if (MAT_BONE == mat) { return 49; }
    if (MAT_SOFT_TISSUE == mat) { return 49; }
    if (MAT_IRON == mat) { return 38; }
    if (MAT_LUNG == mat) { return 49; }
    if (MAT_TITANIUM == mat) { return 38; }
    if (MAT_TEFLON == mat) { return 36; }
    return -1; // ERROR CASE
}

/*
 * NOTE: since the example_projector only uses air, bone, and soft tissue for the
 *  sample phantom, I'm only going to copy those over for now
 */

__device__ const float air_energy_values[38] = {
    1.000000e-03,
    1.500000e-03,
    2.000000e-03,
    3.000000e-03,
    3.202900e-03,
    3.202900e-03,
    4.000000e-03,
    5.000000e-03,
    6.000000e-03,
    8.000000e-03,
    1.000000e-02,
    1.500000e-02,
    2.000000e-02,
    3.000000e-02,
    4.000000e-02,
    5.000000e-02,
    6.000000e-02,
    8.000000e-02,
    1.000000e-01,
    1.500000e-01,
    2.000000e-01,
    3.000000e-01,
    4.000000e-01,
    5.000000e-01,
    6.000000e-01,
    8.000000e-01,
    1.000000e+00,
    1.250000e+00,
    1.500000e+00,
    2.000000e+00,
    3.000000e+00,
    4.000000e+00,
    5.000000e+00,
    6.000000e+00,
    8.000000e+00,
    1.000000e+01,
    1.500000e+01,
    2.000000e+01
};

__device__ const float air_attenuation_coef[38] = {
    3.606000e+03,
    1.191000e+03,
    5.279000e+02,
    1.625000e+02,
    1.340000e+02,
    1.485000e+02,
    7.788000e+01,
    4.027000e+01,
    2.341000e+01,
    9.921000e+00,
    5.120000e+00,
    1.614000e+00,
    7.779000e-01,
    3.538000e-01,
    2.485000e-01,
    2.080000e-01,
    1.875000e-01,
    1.662000e-01,
    1.541000e-01,
    1.356000e-01,
    1.233000e-01,
    1.067000e-01,
    9.549000e-02,
    8.712000e-02,
    8.055000e-02,
    7.074000e-02,
    6.358000e-02,
    5.687000e-02,
    5.175000e-02,
    4.447000e-02,
    3.581000e-02,
    3.079000e-02,
    2.751000e-02,
    2.522000e-02,
    2.225000e-02,
    2.045000e-02,
    1.810000e-02,
    1.705000e-02
};

__device__ const float air_absorbtion_coef[38] = {
    3.599000e+03,
    1.188000e+03,
    5.262000e+02,
    1.614000e+02,
    1.330000e+02,
    1.460000e+02,
    7.636000e+01,
    3.931000e+01,
    2.270000e+01,
    9.446000e+00,
    4.742000e+00,
    1.334000e+00,
    5.389000e-01,
    1.537000e-01,
    6.833000e-02,
    4.098000e-02,
    3.041000e-02,
    2.407000e-02,
    2.325000e-02,
    2.496000e-02,
    2.672000e-02,
    2.872000e-02,
    2.949000e-02,
    2.966000e-02,
    2.953000e-02,
    2.882000e-02,
    2.789000e-02,
    2.666000e-02,
    2.547000e-02,
    2.345000e-02,
    2.057000e-02,
    1.870000e-02,
    1.740000e-02,
    1.647000e-02,
    1.525000e-02,
    1.450000e-02,
    1.353000e-02,
    1.311000e-02    
};

__device__ const float bone_energy_values[49] = {
    1.000000e-03,
    1.035420e-03,
    1.072100e-03,
    1.072100e-03,
    1.182830e-03,
    1.305000e-03,
    1.305000e-03,
    1.500000e-03,
    2.000000e-03,
    2.145500e-03,
    2.145500e-03,
    2.302970e-03,
    2.472000e-03,
    2.472000e-03,
    3.000000e-03,
    4.000000e-03,
    4.038100e-03,
    4.038100e-03,
    5.000000e-03,
    6.000000e-03,
    8.000000e-03,
    1.000000e-02,
    1.500000e-02,
    2.000000e-02,
    3.000000e-02,
    4.000000e-02,
    5.000000e-02,
    6.000000e-02,
    8.000000e-02,
    1.000000e-01,
    1.500000e-01,
    2.000000e-01,
    3.000000e-01,
    4.000000e-01,
    5.000000e-01,
    6.000000e-01,
    8.000000e-01,
    1.000000e+00,
    1.250000e+00,
    1.500000e+00,
    2.000000e+00,
    3.000000e+00,
    4.000000e+00,
    5.000000e+00,
    6.000000e+00,
    8.000000e+00,
    1.000000e+01,
    1.500000e+01,
    2.000000e+01
};

__device__ const float bone_attenuation_coef[49] = {
    3.781000e+03,
    3.452000e+03,
    3.150000e+03,
    3.156000e+03,
    2.434000e+03,
    1.873000e+03,
    1.883000e+03,
    1.295000e+03,
    5.869000e+02,
    4.824000e+02,
    7.114000e+02,
    5.916000e+02,
    4.907000e+02,
    4.962000e+02,
    2.958000e+02,
    1.331000e+02,
    1.296000e+02,
    3.332000e+02,
    1.917000e+02,
    1.171000e+02,
    5.323000e+01,
    2.851000e+01,
    9.032000e+00,
    4.001000e+00,
    1.331000e+00,
    6.655000e-01,
    4.242000e-01,
    3.148000e-01,
    2.229000e-01,
    1.855000e-01,
    1.480000e-01,
    1.309000e-01,
    1.113000e-01,
    9.908000e-02,
    9.022000e-02,
    8.332000e-02,
    7.308000e-02,
    6.566000e-02,
    5.871000e-02,
    5.346000e-02,
    4.607000e-02,
    3.745000e-02,
    3.257000e-02,
    2.946000e-02,
    2.734000e-02,
    2.467000e-02,
    2.314000e-02,
    2.132000e-02,
    2.068000e-02    
};

__device__ const float bone_absorbtion_coef[49] = {
    3.772000e+03,
    3.444000e+03,
    3.143000e+03,
    3.149000e+03,
    2.429000e+03,
    1.869000e+03,
    1.878000e+03,
    1.291000e+03,
    5.846000e+02,
    4.803000e+02,
    6.961000e+02,
    5.789000e+02,
    4.805000e+02,
    4.857000e+02,
    2.897000e+02,
    1.303000e+02,
    1.269000e+02,
    3.006000e+02,
    1.757000e+02,
    1.085000e+02,
    4.987000e+01,
    2.680000e+01,
    8.388000e+00,
    3.601000e+00,
    1.070000e+00,
    4.507000e-01,
    2.336000e-01,
    1.400000e-01,
    6.896000e-02,
    4.585000e-02,
    3.183000e-02,
    3.003000e-02,
    3.032000e-02,
    3.069000e-02,
    3.073000e-02,
    3.052000e-02,
    2.973000e-02,
    2.875000e-02,
    2.745000e-02,
    2.623000e-02,
    2.421000e-02,
    2.145000e-02,
    1.975000e-02,
    1.864000e-02,
    1.788000e-02,
    1.695000e-02,
    1.644000e-02,
    1.587000e-02,
    1.568000e-02    
};

__device__ const float soft_tissue_energy_values[49] = {
    1.000000e-03,
    1.035420e-03,
    1.072100e-03,
    1.072100e-03,
    1.500000e-03,
    2.000000e-03,
    2.145500e-03,
    2.145500e-03,
    2.302970e-03,
    2.472000e-03,
    2.472000e-03,
    2.641400e-03,
    2.822400e-03,
    2.822400e-03,
    3.000000e-03,
    3.607400e-03,
    3.607400e-03,
    4.000000e-03,
    5.000000e-03,
    6.000000e-03,
    8.000000e-03,
    1.000000e-02,
    1.500000e-02,
    2.000000e-02,
    3.000000e-02,
    4.000000e-02,
    5.000000e-02,
    6.000000e-02,
    8.000000e-02,
    1.000000e-01,
    1.500000e-01,
    2.000000e-01,
    3.000000e-01,
    4.000000e-01,
    5.000000e-01,
    6.000000e-01,
    8.000000e-01,
    1.000000e+00,
    1.250000e+00,
    1.500000e+00,
    2.000000e+00,
    3.000000e+00,
    4.000000e+00,
    5.000000e+00,
    6.000000e+00,
    8.000000e+00,
    1.000000e+01,
    1.500000e+01,
    2.000000e+01    
};

__device__ const float soft_tissue_attenuation_coef[49] = {
    3.712000e+03,
    3.386000e+03,
    3.087000e+03,
    3.099000e+03,
    1.251000e+03,
    5.596000e+02,
    4.583000e+02,
    4.650000e+02,
    3.800000e+02,
    3.102000e+02,
    3.158000e+02,
    2.612000e+02,
    2.158000e+02,
    2.188000e+02,
    1.836000e+02,
    1.073000e+02,
    1.105000e+02,
    8.161000e+01,
    4.224000e+01,
    2.456000e+01,
    1.042000e+01,
    5.379000e+00,
    1.699000e+00,
    8.230000e-01,
    3.790000e-01,
    2.688000e-01,
    2.264000e-01,
    2.048000e-01,
    1.823000e-01,
    1.693000e-01,
    1.492000e-01,
    1.358000e-01,
    1.175000e-01,
    1.052000e-01,
    9.598000e-02,
    8.873000e-02,
    7.793000e-02,
    7.006000e-02,
    6.265000e-02,
    5.701000e-02,
    4.895000e-02,
    3.931000e-02,
    3.369000e-02,
    3.000000e-02,
    2.741000e-02,
    2.401000e-02,
    2.193000e-02,
    1.915000e-02,
    1.787000e-02,    
};

__device__ const float soft_tissue_absorbtion_coef[49] = {
    3.701000e+03,
    3.376000e+03,
    3.079000e+03,
    3.090000e+03,
    1.247000e+03,
    5.577000e+02,
    4.566000e+02,
    4.629000e+02,
    3.782000e+02,
    3.086000e+02,
    3.137000e+02,
    2.594000e+02,
    2.142000e+02,
    2.169000e+02,
    1.819000e+02,
    1.061000e+02,
    1.089000e+02,
    8.030000e+01,
    4.135000e+01,
    2.389000e+01,
    9.935000e+00,
    4.987000e+00,
    1.402000e+00,
    5.663000e-01,
    1.616000e-01,
    7.216000e-02,
    4.360000e-02,
    3.264000e-02,
    2.617000e-02,
    2.545000e-02,
    2.745000e-02,
    2.942000e-02,
    3.164000e-02,
    3.249000e-02,
    3.269000e-02,
    3.254000e-02,
    3.176000e-02,
    3.074000e-02,
    2.938000e-02,
    2.807000e-02,
    2.583000e-02,
    2.259000e-02,
    2.045000e-02,
    1.895000e-02,
    1.786000e-02,
    1.639000e-02,
    1.547000e-02,
    1.422000e-02,
    1.362000e-02    
};

/*
 * TODO: copy over the other materials
 */

__device__ const float *mat_energy_values(materialType_t mat) {
    if (MAT_AIR == mat) { return &air_energy_values; }
    if (MAT_BONE == mat) { return &bone_energy_values; }
    if (MAT_SOFT_TISSUE == mat) { return &soft_tissue_energy_values; }
    return NULL; // ERROR CASE
}
